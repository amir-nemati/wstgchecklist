<!DOCTYPE html>

<html lang="fa">
<head>
<meta charset="UTF-8">
<title>داشبورد WSTG فارسی</title>
<style>
body {margin:0; font-family: Tahoma,sans-serif; background:#121212; color:#eee;}
header {background:#1f1f1f; padding:20px; text-align:center; font-size:2em; color:#fbc02d;}
.container {max-width:1200px; margin:auto; padding:20px;}
section {margin-bottom:20px; border:1px solid #333; border-radius:10px; padding:15px; background:#1e1e1e;}
h2 {color:#fbc02d;}
ul li {margin-bottom:10px; padding:8px; background:#2a2a2a; border-radius:5px; list-style:none;}
code {background:#333; padding:2px 5px; border-radius:3px; display:block; margin-top:5px; color:#4caf50;}
input,textarea,button {width:100%; padding:8px; margin-top:5px; border-radius:5px; border:none; outline:none;}
input,textarea {background:#2a2a2a; color:#eee;}
button {background:#fbc02d; color:#121212; cursor:pointer; font-weight:bold;}
button:hover {background:#ffeb3b;}
</style>
</head>
<body>
<header>داشبورد کامل WSTG فارسی</header>
<div class="container">
<h2>اضافه کردن چک‌لیست جدید</h2>
<input type="text" id="title" placeholder="عنوان تست">
<textarea id="desc" placeholder="توضیح دقیق تست"></textarea>
<input type="text" id="tools" placeholder="ابزار مورد نیاز (کاما جدا کنید)">
<textarea id="cmd" placeholder="کامند مثال"></textarea>
<button onclick="addItem()">اضافه کن</button>

<h2>لیست چک‌لیست‌ها</h2>
<ul id="list"></ul>
</div>

<script>
const listEl = document.getElementById('list');

function loadItems(){
  const items = JSON.parse(localStorage.getItem('wstg') || '[]');
  listEl.innerHTML = '';
  items.forEach(it => {
    const li = document.createElement('li');
    li.innerHTML = `<b>${it.title}</b><br>${it.desc}<br><i>ابزار: ${it.tools}</i><br><code>${it.cmd}</code>`;
    listEl.appendChild(li);
  });
}

function addItem(){
  const item = {
    title: document.getElementById('title').value,
    desc: document.getElementById('desc').value,
    tools: document.getElementById('tools').value,
    cmd: document.getElementById('cmd').value
  };
  if(!item.title || !item.desc) return alert('عنوان و توضیح ضروری هستند!');
  const items = JSON.parse(localStorage.getItem('wstg') || '[]');
  items.push(item);
  localStorage.setItem('wstg', JSON.stringify(items));
  document.getElementById('title').value = '';
  document.getElementById('desc').value = '';
  document.getElementById('tools').value = '';
  document.getElementById('cmd').value = '';
  loadItems();
}

const initial = [

/* ==============================
4.1 Information Gathering
============================== */

{
 title:"4.1.1 جمع‌آوری اطلاعات از موتورهای جستجو (OSINT)",
 desc:"هدف: شناسایی اطلاعات افشا شده درباره هدف از طریق گوگل، بینگ و ... شامل دامین‌های فرعی، فایل‌های حساس، ایمیل‌ها و پنل‌های مدیریتی.",
 tools:"Google Dorks, theHarvester, Amass",
 cmd:`site:target.com filetype:sql OR filetype:bak
amass enum -d target.com

theHarvester -d target.com -b google`
},
{
 title:"4.1.2 شناسایی Web Server",
 desc:"هدف: تشخیص نوع وب سرور و نسخه آن جهت بررسی آسیب‌پذیری‌های شناخته‌شده.",
 tools:"nmap, whatweb, curl",
 cmd:`nmap -sV -p 80,443 target.com
whatweb https://target.com
curl -I https://target.com`
},

/* ==============================
4.2 Configuration & Deployment
============================== */

{
 title:"4.2.6 تست HTTP Methods",
 desc:"بررسی فعال بودن متدهای خطرناک مانند PUT, DELETE, TRACE که ممکن است امکان آپلود یا حملات XST بدهند.",
 tools:"nmap, Burp Suite, curl",
 cmd:`nmap --script http-methods -p 80 target.com
curl -X TRACE https://target.com`
},
{
 title:"4.2.10 Subdomain Takeover",
 desc:"بررسی CNAMEهای بدون استفاده که به سرویس‌های حذف‌شده اشاره می‌کنند.",
 tools:"subfinder, dig",
 cmd:`subfinder -d target.com
dig sub.target.com`
},

/* ==============================
4.3 Authentication Testing
============================== */

{
 title:"4.4.2 تست Default Credentials",
 desc:"بررسی وجود حساب‌های پیش‌فرض با پسوردهای ساده.",
 tools:"Hydra, Medusa",
 cmd:`hydra -l admin -P rockyou.txt target.com http-post-form`
},
{
 title:"4.4.7 تست سیاست رمز عبور ضعیف",
 desc:"بررسی حداقل طول رمز، پیچیدگی و نبود rate limiting.",
 tools:"Burp Intruder",
 cmd:`ارسال لیست پسوردهای ضعیف از طریق Intruder و بررسی پاسخ‌ها`
},

/* ==============================
4.5 Authorization
============================== */

{
 title:"4.5.4 Insecure Direct Object Reference (IDOR)",
 desc:"تغییر مستقیم شناسه‌های عددی یا UUID برای دسترسی به داده کاربران دیگر.",
 tools:"Burp Suite",
 cmd:`GET /api/user?id=1001 -> تغییر به 1002`
},

/* ==============================
4.6 Session Management
============================== */

{
 title:"4.6.3 Session Fixation",
 desc:"بررسی عدم تغییر session id پس از لاگین.",
 tools:"Burp Suite",
 cmd:`قبل از لاگین session را ذخیره کن و بررسی کن بعد از لاگین تغییر کرده یا نه`
},

/* ==============================
4.7 Input Validation
============================== */

{
 title:"4.7.5 SQL Injection",
 desc:"تزریق کاراکترهای خاص برای استخراج داده از پایگاه داده.",
 tools:"sqlmap, Burp Suite",
 cmd:`sqlmap -u "https://target.com/page?id=1" --dbs --batch`
},
{
 title:"4.7.1 Reflected XSS",
 desc:"تزریق اسکریپت در پارامتر و بررسی بازتاب آن در پاسخ HTML.",
 tools:"Burp Suite, OWASP ZAP",
 cmd:`<script>alert(1)</script>`

},
{
title:"4.7.12 Command Injection",
desc:"تزریق دستورات سیستم‌عامل در پارامترهای ورودی.",
tools:"Burp Suite",
cmd:`;id
&& whoami`
},
{
title:"4.7.19 Server-Side Request Forgery (SSRF)",
desc:"ارسال درخواست به سرویس‌های داخلی از طریق پارامتر URL.",
tools:"Burp Suite",
cmd:`http://127.0.0.1:80`
},

/* ==============================
4.8 Error Handling
============================== */

{
title:"4.8.1 Improper Error Handling",
desc:"بررسی نمایش Stack Trace یا خطاهای دیتابیس در پاسخ.",
tools:"Burp Suite",
cmd:`ارسال ورودی غیرمجاز مانند ' در فرم‌ها`
},

/* ==============================
4.9 Weak Cryptography
============================== */

{
title:"4.9.1 Weak TLS",
desc:"بررسی نسخه‌های قدیمی SSL/TLS.",
tools:"nmap, sslscan",
cmd:`nmap --script ssl-enum-ciphers -p 443 target.com`
},

/* ==============================
4.10 Business Logic
============================== */

{
title:"4.10.6 Circumvention of Workflows",
desc:"رد کردن مراحل اجباری خرید یا پرداخت.",
tools:"Burp Suite",
cmd:`حذف مرحله پرداخت و ارسال مستقیم درخواست نهایی`
},

/* ==============================
4.11 Client-Side
============================== */

{
title:"4.11.9 Clickjacking",
desc:"بررسی امکان iframe شدن سایت بدون X-Frame-Options.",
tools:"Browser DevTools",
cmd:`<iframe src=\"https://target.com\"></iframe>`
},

/* ==============================
4.12 API Testing
============================== */

{
title:"4.12.1 GraphQL Testing",
desc:"بررسی introspection فعال و دسترسی غیرمجاز به schema.",
tools:"Burp Suite, curl",
cmd:`curl -X POST https://target.com/graphql -d '{"query":"{__schema{types{name}}}"}'`
}

];

if(!localStorage.getItem('wstg')) localStorage.setItem('wstg', JSON.stringify(initial));

loadItems(); </script>

</body>
</html>
